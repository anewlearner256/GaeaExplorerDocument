:github_url: hide

.. Generated automatically by doc/tools/make_rst.py in GaaeExplorer's source tree.
.. DO NOT EDIT THIS FILE, but the SkeletonIK.xml source instead.
.. The source is found in doc/classes or modules/<name>/doc_classes.

.. _class_SkeletonIK:

SkeletonIK
==========

**Inherits:** :ref:`Node<class_Node>` **<** :ref:`Object<class_Object>`

SkeletonIK用于将\ :ref:`Skeleton<class_Skeleton>`\ 骨链的末端骨骼置于3D中的某一点，并相应地旋转骨链中的所有骨骼。

描述
----

SkeletonIK用于将\ :ref:`Skeleton<class_Skeleton>`\ 骨链的末端骨骼放置在3D某一点上，并相应地旋转骨链中的所有骨骼。游戏中IK的典型场景是将角色的脚放在地面上，或者将角色的手放在当前持有的物体上。SkeletonIK在内部使用FabrikInverseKinematic来解决骨骼链，并将结果应用于\ :ref:`Skeleton<class_Skeleton>` ``bones_global_pose_override``\ 属性中所有受影响的骨骼链。如果完全应用，这将覆盖任何来自\ :ref:`Animation<class_Animation>`\ 的骨骼变换或用户设置的骨骼自定义姿势。应用量可以用\ ``interpolation``\ 属性来控制。

::

    # 在每一个新的帧上自动应用IK效果（不是当前的）。
    skeleton_ik_node.start()
    
    # 只在当前帧上应用IK效果
    skeleton_ik_node.start(true)
    
    # 停止IK效果并重置骨骼上的bones_global_pose_override
    skeleton_ik_node.stop()
    
    # 应用完整的IK效果
    skeleton_ik_node.set_interpolation(1.0)
    
    # 应用一半的IK效果
    skeleton_ik_node.set_interpolation(0.5)
    
    # 应用零IK效果（数值为0.01或低于0.01也会移除骨骼上的bones_global_pose_override）。
    skeleton_ik_node.set_interpolation(0.0)

教程
----

- `3D Inverse Kinematics Demo <https://godotengine.org/asset-library/asset/523>`__

属性
----

+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`float<class_float>`         | :ref:`interpolation<class_SkeletonIK_property_interpolation>`           | ``1.0``                                             |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`Vector3<class_Vector3>`     | :ref:`magnet<class_SkeletonIK_property_magnet>`                         | ``Vector3( 0, 0, 0 )``                              |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`int<class_int>`             | :ref:`max_iterations<class_SkeletonIK_property_max_iterations>`         | ``10``                                              |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`float<class_float>`         | :ref:`min_distance<class_SkeletonIK_property_min_distance>`             | ``0.01``                                            |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`bool<class_bool>`           | :ref:`override_tip_basis<class_SkeletonIK_property_override_tip_basis>` | ``true``                                            |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`String<class_String>`       | :ref:`root_bone<class_SkeletonIK_property_root_bone>`                   | ``""``                                              |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`Transform<class_Transform>` | :ref:`target<class_SkeletonIK_property_target>`                         | ``Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0 )`` |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`NodePath<class_NodePath>`   | :ref:`target_node<class_SkeletonIK_property_target_node>`               | ``NodePath("")``                                    |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`String<class_String>`       | :ref:`tip_bone<class_SkeletonIK_property_tip_bone>`                     | ``""``                                              |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+
| :ref:`bool<class_bool>`           | :ref:`use_magnet<class_SkeletonIK_property_use_magnet>`                 | ``false``                                           |
+-----------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------+

方法
----

+---------------------------------+------------------------------------------------------------------------------------------------+
| :ref:`Skeleton<class_Skeleton>` | :ref:`get_parent_skeleton<class_SkeletonIK_method_get_parent_skeleton>` **(** **)** |const|    |
+---------------------------------+------------------------------------------------------------------------------------------------+
| :ref:`bool<class_bool>`         | :ref:`is_running<class_SkeletonIK_method_is_running>` **(** **)**                              |
+---------------------------------+------------------------------------------------------------------------------------------------+
| void                            | :ref:`start<class_SkeletonIK_method_start>` **(** :ref:`bool<class_bool>` one_time=false **)** |
+---------------------------------+------------------------------------------------------------------------------------------------+
| void                            | :ref:`stop<class_SkeletonIK_method_stop>` **(** **)**                                          |
+---------------------------------+------------------------------------------------------------------------------------------------+

属性说明
--------

.. _class_SkeletonIK_property_interpolation:

- :ref:`float<class_float>` **interpolation**

+-----------+--------------------------+
| *Default* | ``1.0``                  |
+-----------+--------------------------+
| *Setter*  | set_interpolation(value) |
+-----------+--------------------------+
| *Getter*  | get_interpolation()      |
+-----------+--------------------------+

IK 效果应用于当前骨架骨骼链的插值。 ``1.0`` 的值将完全覆盖所有骨架骨骼变换，而 ``0.0`` 的值将在视觉上禁用 SkeletonIK。等于或低于 ``0.01`` 的值也调用 :ref:`Skeleton.clear_bones_global_pose_override<class_Skeleton_method_clear_bones_global_pose_override>`\ 。

----

.. _class_SkeletonIK_property_magnet:

- :ref:`Vector3<class_Vector3>` **magnet**

+-----------+----------------------------+
| *Default* | ``Vector3( 0, 0, 0 )``     |
+-----------+----------------------------+
| *Setter*  | set_magnet_position(value) |
+-----------+----------------------------+
| *Getter*  | get_magnet_position()      |
+-----------+----------------------------+

IK 链的次要目标位置（首先是 :ref:`target<class_SkeletonIK_property_target>` 属性或 :ref:`target_node<class_SkeletonIK_property_target_node>`\ ）。使用磁铁位置（极点目标）来控制 IK 链的弯曲。仅当骨骼链具有 2 个以上的骨骼时才有效。中间链骨位置将与磁铁位置进行线性插值。

----

.. _class_SkeletonIK_property_max_iterations:

- :ref:`int<class_int>` **max_iterations**

+-----------+---------------------------+
| *Default* | ``10``                    |
+-----------+---------------------------+
| *Setter*  | set_max_iterations(value) |
+-----------+---------------------------+
| *Getter*  | get_max_iterations()      |
+-----------+---------------------------+

IK解算器使用的迭代循环的数量，以产生更准确（和优雅）的骨链效果。

----

.. _class_SkeletonIK_property_min_distance:

- :ref:`float<class_float>` **min_distance**

+-----------+-------------------------+
| *Default* | ``0.01``                |
+-----------+-------------------------+
| *Setter*  | set_min_distance(value) |
+-----------+-------------------------+
| *Getter*  | get_min_distance()      |
+-----------+-------------------------+

骨骼与目标对象之间的最小距离。如果距离低于这个值，IK解算器将停止进一步的迭代。

----

.. _class_SkeletonIK_property_override_tip_basis:

- :ref:`bool<class_bool>` **override_tip_basis**

+-----------+-------------------------------+
| *Default* | ``true``                      |
+-----------+-------------------------------+
| *Setter*  | set_override_tip_basis(value) |
+-----------+-------------------------------+
| *Getter*  | is_override_tip_basis()       |
+-----------+-------------------------------+

如果\ ``true``\ ，则用 :ref:`target<class_SkeletonIK_property_target>` （或者如果定义了\ :ref:`target_node<class_SkeletonIK_property_target_node>`]）的旋转覆盖尖端骨骼的旋转。

----

.. _class_SkeletonIK_property_root_bone:

- :ref:`String<class_String>` **root_bone**

+-----------+----------------------+
| *Default* | ``""``               |
+-----------+----------------------+
| *Setter*  | set_root_bone(value) |
+-----------+----------------------+
| *Getter*  | get_root_bone()      |
+-----------+----------------------+

当前根骨的名称，即IK链中的第一个骨。

----

.. _class_SkeletonIK_property_target:

- :ref:`Transform<class_Transform>` **target**

+-----------+-----------------------------------------------------+
| *Default* | ``Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0 )`` |
+-----------+-----------------------------------------------------+
| *Setter*  | set_target_transform(value)                         |
+-----------+-----------------------------------------------------+
| *Getter*  | get_target_transform()                              |
+-----------+-----------------------------------------------------+

放置尖端骨骼的 IK 链的第一个目标，如果 :ref:`override_tip_basis<class_SkeletonIK_property_override_tip_basis>` 是 ``true``\ ，尖端骨骼的旋转方式。如果 :ref:`target_node<class_SkeletonIK_property_target_node>` 路径可用，则使用节点变换，并忽略此属性。

----

.. _class_SkeletonIK_property_target_node:

- :ref:`NodePath<class_NodePath>` **target_node**

+-----------+------------------------+
| *Default* | ``NodePath("")``       |
+-----------+------------------------+
| *Setter*  | set_target_node(value) |
+-----------+------------------------+
| *Getter*  | get_target_node()      |
+-----------+------------------------+

IK链的目标节点\ :ref:`NodePath<class_NodePath>`\ 。如果有的话，将使用节点当前的\ :ref:`Transform<class_Transform>`\ ，而不是\ :ref:`target<class_SkeletonIK_property_target>`\ 属性。

----

.. _class_SkeletonIK_property_tip_bone:

- :ref:`String<class_String>` **tip_bone**

+-----------+---------------------+
| *Default* | ``""``              |
+-----------+---------------------+
| *Setter*  | set_tip_bone(value) |
+-----------+---------------------+
| *Getter*  | get_tip_bone()      |
+-----------+---------------------+

当前尖端骨骼的名称，IK 链中放置在 :ref:`target<class_SkeletonIK_property_target>` 变换处的最后一个骨骼（或者已定义 :ref:`target_node<class_SkeletonIK_property_target_node>`\ ）。

----

.. _class_SkeletonIK_property_use_magnet:

- :ref:`bool<class_bool>` **use_magnet**

+-----------+-----------------------+
| *Default* | ``false``             |
+-----------+-----------------------+
| *Setter*  | set_use_magnet(value) |
+-----------+-----------------------+
| *Getter*  | is_using_magnet()     |
+-----------+-----------------------+

如果\ ``true``\ ，指示IK求解器在解算器链时考虑次要磁铁目标（极点目标）。使用磁铁位置（磁极目标）来控制IK链的弯曲。

方法说明
--------

.. _class_SkeletonIK_method_get_parent_skeleton:

- :ref:`Skeleton<class_Skeleton>` **get_parent_skeleton** **(** **)** |const|

返回 SkeletonIK 进入 :ref:`SceneTree<class_SceneTree>` 时存在的父 :ref:`Skeleton<class_Skeleton>` 节点。如果父节点在 SkeletonIK 进入 :ref:`SceneTree<class_SceneTree>` 时不是 :ref:`Skeleton<class_Skeleton>` 节点，则返回 null。

----

.. _class_SkeletonIK_method_is_running:

- :ref:`bool<class_bool>` **is_running** **(** **)**

如果 SkeletonIK 将 IK 效果应用到 :ref:`Skeleton<class_Skeleton>` 骨骼的连续帧上，则返回 ``true``\ 。如果 SkeletonIK 停止或使用 :ref:`start<class_SkeletonIK_method_start>` 且 ``one_time`` 参数设置为 ``true``\ ，则返回 ``false``\ 。

----

.. _class_SkeletonIK_method_start:

- void **start** **(** :ref:`bool<class_bool>` one_time=false **)**

开始将 IK 效果应用到每一帧的 :ref:`Skeleton<class_Skeleton>` 骨骼，但只会在下一帧开始生效。如果 ``one_time`` 为 ``true``\ ，这将立即生效，但会在下一帧重置。

----

.. _class_SkeletonIK_method_stop:

- void **stop** **(** **)**

停止将 IK 效果应用到每帧的 :ref:`Skeleton<class_Skeleton>` 骨骼，并调用 :ref:`Skeleton.clear_bones_global_pose_override<class_Skeleton_method_clear_bones_global_pose_override>` 以移除所有骨骼上的现有覆盖。

.. |virtual| replace:: :abbr:`virtual (This method should typically be overridden by the user to have any effect.)`
.. |const| replace:: :abbr:`const (This method has no side effects. It doesn't modify any of the instance's member variables.)`
.. |vararg| replace:: :abbr:`vararg (This method accepts any number of arguments after the ones described here.)`
